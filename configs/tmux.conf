# Enable 256-color and sane defaults
set -g default-terminal "tmux-256color"
set -g history-limit 100000
setw -g mode-keys vi

# https://github.com/microsoft/vscode/issues/207545#issuecomment-2016247034
set -g escape-time 100

# Enable mouse support
set -g mouse on

# Sync tmux copy to system clipboard
set -g set-clipboard on

# Scroll wheel enters copy-mode and scrolls tmux history
# This avoids forwarding wheel events to TUI apps that move the cursor
bind -n WheelUpPane if-shell -F -t = "#{pane_in_mode}" \
  "send-keys -M" \
  "copy-mode -e; send-keys -M"

# While in copy-mode, keep scrolling with the wheel
bind -T copy-mode-vi WheelUpPane send-keys -X scroll-up
bind -T copy-mode-vi WheelDownPane send-keys -X scroll-down

# For symmetry: when already in copy-mode, pass wheel down to copy-mode;
# otherwise pass through (lets you exit copy-mode by scrolling to bottom)
bind -n WheelDownPane if-shell -F -t = "#{pane_in_mode}" \
  "send-keys -M" \
  "send-keys -M"

# Optional: PageUp enters copy-mode and pages up
bind -n PageUp if-shell -F "#{pane_in_mode}" \
  "send-keys -X page-up" \
  "copy-mode -e; send-keys -X page-up"

# Run dev and maintenance scripts on tmux attach
set-hook -g client-attached 'run-shell "/bin/bash /etc/tmux-on-attach.sh"'

